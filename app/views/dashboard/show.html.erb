<hgroup class="dashboard">

  <h2>User Dashboard</h2>
  <div class="owner-renter-toggle">
    <button id="dashboard_button_summary">Summary</button>
    <button id="dashboard_button_owner">Owner</button>
    <button id="dashboard_button_renter">Renter</button>
  </div>

</hgroup>

<main class="dashboard">

  <section>
    <h2>The Tools you Own</h2>
    <% @user.tools.each do |tool| %>
      <a href="<%= tool_path(tool) %>"><p> <%= tool.abstract_tool.name.split.map(&:capitalize).join(' ') %></a> | $<%= tool.base_price %> <%= link_to 'Show', tool_path(tool) %> <%= link_to 'Edit', edit_tool_path(tool) %></p>
    <% end %>
    <p> Total: $<%= @user.owner_sum_all_tools || 0 %></p>

    <h2>Tools Not Currently Being Rented</h2>
    <% @user.tools.each do |tool| %>
      <% if tool.available == true %>
        <p> <a href="<%= tool_path(tool) %>"><%= tool.abstract_tool.name.split.map(&:capitalize).join(' ')%></a> | $<%= tool.base_price %> <%= link_to 'Show', tool_path(tool) %> <%= link_to 'Edit', edit_tool_path(tool) %> </p>
      <% end %>
    <% end %>
    <p> Total: $<%= @user.owner_sum_inactive_tools || 0 %></p>

    <h2>Tools Actively Rented</h2>
    <% @user.tools.each do |tool| %>
      <% if tool.available == false %>
        <p> <a href="<%= tool_path(tool) %>"><%= tool.abstract_tool.name.split.map(&:capitalize).join(' ') %></a> | $<%= tool.base_price %> <%= link_to 'Show', tool_path(tool) %> <%= link_to 'Edit', edit_tool_path(tool) %> </p>
      <% end %>
    <% end %>
    <p> Total: $<%= @user.owner_sum_rented_tools  || 0 %></p>
    <p><%= link_to "Add Tool to your Owner's Shed", new_tool_path  %> </p>
  </section>

  <article>
    <!-- Or logic for the idea we discussed: -->
    <h2>Rental Agreements</h2>
    <% @rented_rentals.each do |rental| %>
      <p> <a href="<%= rental_path(rental) %>">Transaction ID: <%= rental.id %></a> | with User: <%= rental.owner.username %> </p>
      <p> Status: <%= rental.status.capitalize %></p>
      <p> Picked Up: <%= rental.checkout_date.strftime("%m/%d/%y") %> | Due Back: <%= rental.return_date.strftime("%m/%d/%y") %> </p>
     <% end %>

    <h2 id="dashboard_all_tools">Tools You're Renting</h2>
    <div class="hidden">
      <% @user.rented_line_items.each do |li| %>
        <p> <a href="<%= tool_path(li.tool) %>"><%= li.tool.abstract_tool.name.split.map(&:capitalize).join(' ')%></a> | $<%= li.tool.base_price %> | Status: <%= li.rental.status %> </p>
        <p> Picked Up: <%= li.checkout_date.strftime("%m/%d/%y") %> | Due Back: <%= li.return_date.strftime("%m/%d/%y") %> </p>
      <% end %>
    </div>
  </article>

  <aside>
     <h3>You have a rental request from:</h3>
     <% if @owned_rentals.any? %>
      <ul>
      <% @owned_rentals.each do |o_rental|  %>
        <% unless o_rental.status == "draft" %><li><%= link_to "#{o_rental.renter.username} -- #{o_rental.status}", rental_path(o_rental) %></li><% end %>
      <% end %>
    </ul>
    <% end %>
    <h3>You have open rental requests with:</h3>
    <% if @rented_rentals.any? %>
    <ul>
      <% @rented_rentals.each do |r_rental|  %>
        <li><%= link_to "#{r_rental.owner.username} -- #{r_rental.status}", rental_path(r_rental) %></li>
      <% end %>
    </ul>
    <% end %>
  </aside>

</main>
